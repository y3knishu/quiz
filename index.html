<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NEET PG / INICET PYQs</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg,#ff9a9e,#fad0c4,#fbc2eb,#a1c4fd,#c2e9fb);
      background-size:400% 400%;
      animation:gradientBG 15s ease infinite;
      color:#fff;margin:0;padding:20px;
    }
    @keyframes gradientBG{0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;}}
    header{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;margin-bottom:20px;}
    h1{font-size:1.8em;margin:0;}
    .top-buttons{display:flex;flex-direction:column;align-items:flex-end;}
    .info-message{text-align:center;background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;margin-bottom:20px;font-weight:bold;}
    .subjects{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:15px;max-width:1200px;margin:auto;}
    .card{padding:16px;border-radius:10px;text-align:center;text-decoration:none;color:white;font-weight:bold;transition:transform 0.2s;}
    .card:hover{transform:scale(1.05);}
    .card.locked{filter:grayscale(60%);opacity:0.6;cursor:not-allowed;}
    .card-title{font-size:1.1em;margin-bottom:6px;}
    .card-sub{font-size:0.9em;}
    .card:nth-child(1){background:#ff9a9e;} .card:nth-child(2){background:#fbc2eb;} .card:nth-child(3){background:#a18cd1;}
    .card:nth-child(4){background:#fad0c4;} .card:nth-child(5){background:#fbc8d4;} .card:nth-child(6){background:#c2e9fb;}
    .card:nth-child(7){background:#d4fc79;} .card:nth-child(8){background:#96e6a1;} .card:nth-child(9){background:#fddb92;}
    .card:nth-child(10){background:#a1c4fd;} .card:nth-child(11){background:#84fab0;} .card:nth-child(12){background:#8fd3f4;}
    .card:nth-child(13){background:#fccb90;} .card:nth-child(14){background:#ffecd2;} .card:nth-child(15){background:#cfd9df;}
    .card:nth-child(16){background:#e0c3fc;} .card:nth-child(17){background:#f6d365;} .card:nth-child(18){background:#fda085;}
    .card:nth-child(19){background:#fbc2eb;}
    button{padding:8px 14px;font-size:0.9em;border:none;border-radius:4px;background:#333;color:#fff;cursor:pointer;}
    button:hover{background:#555;}
    .whatsapp-button{position:fixed;bottom:20px;right:20px;background-color:#25d366;color:white;border-radius:50%;width:55px;height:55px;font-size:26px;display:flex;justify-content:center;align-items:center;text-decoration:none;box-shadow:0 4px 6px rgba(0,0,0,0.3);z-index:999;}
    @media screen and(max-width:480px){h1{font-size:1.4em;} .info-message{font-size:0.9em;} .card-title{font-size:1em;}}
  </style>
</head>
<body>
  <header>
    <h1>NEET PG / INICET PYQs</h1>
    <div class="top-buttons">
      <div>
        <span id="user‚Äëinfo">Loading...</span>
        <button id="loginBtn" style="display:none">üîê Login / Sign Up</button>
        <button id="logoutBtn" style="display:none">üö™ Logout</button>
      </div>
      <button id="payBtn" style="margin-top:8px;">üí≥ Pay ‚Çπ99 to Unlock All Subjects</button>
    </div>
  </header>

  <div class="info-message">
    üîì <strong>Anatomy</strong> is free. Pay ‚Çπ99 once to unlock all subjects.<br>
    Please login to make payment.
  </div>

  <div id="subject-container" class="subjects"></div>

  <a class="whatsapp-button" href="https://wa.me/919431328569" target="_blank" title="Chat on WhatsApp">üí¨</a>

  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    const firebaseConfig = { /* ‚Ä¶ your config ‚Ä¶ */ };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);
    const subjects = [ "Anatomy", /* etc. */ ];

    let isPaid=false, currentUser=null, userId=null;
    const userInfo=document.getElementById("user‚Äëinfo");
    const loginBtn=document.getElementById("loginBtn");
    const logoutBtn=document.getElementById("logoutBtn");
    const payBtn=document.getElementById("payBtn");

    function renderSubjects(){
      const container=document.getElementById("subject-container");
      container.innerHTML="";
      subjects.forEach(subject=>{
        const card=document.createElement("a");
        card.className="card";
        const locked = subject!=="Anatomy" && !isPaid;
        card.classList.toggle("locked", locked);
        card.innerHTML=\`<div class="card-title">\${subject}</div><div class="card-sub">\${locked?"üîí Locked":"‚úÖ Open"}</div>\`;
        if(!locked) card.href=\`quiz.html?subject=\${encodeURIComponent(subject)}\`;
        else card.onclick=e=>{e.preventDefault();alert("üîí Subject locked. Please login and pay ‚Çπ99.");};
        container.appendChild(card);
      });
    }

    onAuthStateChanged(auth, async user=>{
      if(user){
        currentUser=user;
        userId=user.uid;
        loginBtn.style.display="none"; logoutBtn.style.display="inline-block";
        userInfo.textContent=\`üëã \${user.email}\`;
        const snap=await getDoc(doc(db,"users",user.uid));
        if(user.email==="y3knishu@gmail.com"|| (snap.exists() && snap.data().isPaid)){
          isPaid=true; payBtn.style.display="none";
        } else {
          isPaid=false; payBtn.style.display="inline-block";
        }
      } else {
        currentUser=null; isPaid=false;
        userInfo.textContent="üîê Not logged in";
        loginBtn.style.display="inline-block"; logoutBtn.style.display="none";
        payBtn.style.display="inline-block";
      }
      renderSubjects();
    });

    loginBtn.addEventListener("click",()=>location.href="admin-login.html");
    logoutBtn.addEventListener("click",()=>signOut(auth).then(()=>{alert("Logged out");location.reload();}));

    payBtn.onclick = ()=>{
      if(!currentUser){alert("üîê Please login first.");return;}
      const options = { key:"rzp_live_7nZptAUoDrsfRb", amount:9900, currency:"INR", name:"NEET PG / INICET PYQs", description:"Unlock all subjects", handler:resp=>{
          alert("‚úÖ Payment success! ID: " + resp.razorpay_payment_id);
          setDoc(doc(db,"users",userId),{isPaid:true},{merge:true}).then(()=>{
            isPaid=true; payBtn.style.display="none"; renderSubjects();
          });
        }, theme:{ color:"#3399cc" }};
      new Razorpay(options).open();
    };
  </script>
</body>
</html>
